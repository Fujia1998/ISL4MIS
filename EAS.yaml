openapi: 3.0.0
info:
  version: v1
  title: EAS公开API
tags:
  - name: Accelerator
    description: 加速器生命周期管理
  - name: Flavor
    description: 加速器规格
  - name: NodeType
    description: 加速器节点类型
  - name: AcceleratorCred
    description: 加速器连接凭证管理
  - name: Pool
    description: 加速器资源池管理
  - name: AcceleratorDriver
    description: 加速器驱动
  - name: Node
    description: 池节点管理
paths:
  '/v1/{project_id}/accelerators':
    post:
      tags:
        - EAS
        - Accelerator
      summary: 创建加速器
      description: 创建加速器
      operationId: CreateAccelerators
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAcceleratorsRequestBody'
      responses:
        '202':
          description: successful opration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateAcceleratorsResponseBody'
    get:
      tags:
        - EAS
        - Accelerator
      summary: 查询加速器详情列表
      description: 查询加速器详情列表
      operationId: ListAccelerators
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Marker'
        - name: name
          in: query
          required: false
          description: 加速器名称，模糊匹配
          schema:
            type: string
            pattern: '^[a-zA-Z0-9\u4e00-\u9fa5-._]*$'
        - name: node_id
          in: query
          required: false
          description: 加速器所在节点的ID
          schema:
            type: array
            minItems: 0
            maxItems: 100
            items:
              type: string
              pattern: >-
                [a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}
        - name: flavor_id
          in: query
          required: false
          description: 加速器规格Id
          schema:
            type: array
            minItems: 0
            maxItems: 100
            items:
              type: string
              pattern: '^[a-zA-Z0-9._-]*$'
              minLength: 1
              maxLength: 36
        - name: status
          in: query
          required: false
          description: 加速器状态
          schema:
            minItems: 0
            maxItems: 100
            type: array
            items:
              type: string
              maxLength: 36
        - name: pool_id
          in: query
          required: false
          description: 加速器资源池ID
          schema:
            type: array
            items:
              type: string
              pattern: >-
                [a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}
        - name: id
          in: query
          required: false
          description: 加速器ID
          schema:
            type: array
            items:
              type: string
              pattern: >-
                [a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}
        - name: credential_id
          in: query
          required: false
          description: 加速器关联的凭证ID
          schema:
            type: array
            minItems: 0
            maxItems: 100
            items:
              type: string
              pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
        - name: sort_dir
          in: query
          required: false
          description: '排序顺序, 取值为asc(升序), desc(降序)'
          schema:
            type: array
            items:
              type: string
              pattern: "asc|desc"
        - name: sort_key
          in: query
          required: false
          description: 排序字段名称
          schema:
            type: array
            items:
              type: string
              pattern: "pool_id|name|node_id|flavor_id|status|id|credential_id"
      responses:
        '200':
          description: successful opration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListAcceleratorResponseBody'
  '/v1/{project_id}/accelerators/{accelerator_id}':
    get:
      tags:
        - EAS
        - Accelerator
      summary: 查询加速器详情
      operationId: ShowAccelerator
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - name: accelerator_id
          in: path
          required: true
          description: 加速器ID
          schema:
            type: string
            pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShowAcceleratorResponseBody'
    put:
      tags:
        - EAS
        - Accelerator
      summary: 更新加速器的信息
      operationId: UpdateAccelerator
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - name: accelerator_id
          in: path
          required: true
          description: 加速器ID
          schema:
            type: string
            pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
      requestBody:
        description: 请求参数对象
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAcceleratorRequestBody'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateAcceleratorResponseBody'
  '/v1/{project_id}/accelerators/batch-delete':
    post:
      tags:
        - EAS
        - Accelerator
      summary: 删除加速器
      operationId: BatchDeleteAccelerators
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
      requestBody:
        description: accelerators which need to delete
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteAcceleratorsRequestBody'
      responses:
        '202':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteAcceleratorsResponseBody'
  '/v1/{project_id}/accelerator-flavors/{accelerator_flavor_id}':
    get:
      tags:
        - EAS
        - Flavor
      summary: 查询加速器规格详情
      description: 查询加速器规格详情
      operationId: ShowAcceleratorFlavor
      parameters:
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/ProjectId'
        - name: accelerator_flavor_id
          in: path
          description: 加速器规格id
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9._-]*$'
            minLength: 1
            maxLength: 36
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShowFlavorResponseBody'
  '/v1/{project_id}/accelerator-node-types/{accelerator_node_type_id}':
    get:
      tags:
        - EAS
        - NodeType
      summary: 查询加速器节点类型详情
      description: 查询加速器节点类型详情
      operationId: ShowAcceleratorNodeType
      parameters:
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/ProjectId'
        - name: accelerator_node_type_id
          in: path
          description: 加速器节点类型id
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9._-]*$'
            minLength: 1
            maxLength: 36
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShowNodeTypeResponseBody'
  '/v1/{project_id}/accelerator-flavors':
    get:
      tags:
        - EAS
        - Flavor
      summary: 查询加速器规格列表
      description: 查询加速器规格列表
      operationId: ListAcceleratorFlavors
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Marker'
        - name: name
          in: query
          required: false
          description: 加速器规格名称
          schema:
            type: string
            pattern: '^[a-zA-Z0-9._-]*$'
            minLength: 1
            maxLength: 36
        - name: provide_api
          in: query
          required: false
          description: 加速器规格支持的驱动类型
          schema:
            type: string
            pattern: '^[a-zA-Z0-9._-]*$'
            minLength: 1
            maxLength: 36
        - name: sort_dir
          in: query
          required: false
          description: '排序顺序, 取值为asc(升序), desc(降序)'
          schema:
            type: array
            items:
              type: string
              pattern: "asc|desc"
        - name: sort_key
          in: query
          required: false
          description: '排序字段名称,取值为name(规格名称)，provide_api(规格支持的驱动类型)'
          schema:
            type: array
            items:
              type: string
              pattern: "name|provide_api"
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListFlavorsResponseBody'
  '/v1/{project_id}/accelerator-node-types':
    get:
      tags:
        - EAS
        - NodeType
      summary: 查询加速器节点类型列表
      description: 查询加速器节点类型列表
      operationId: ListAcceleratorNodeTypes
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Marker'
        - name: name
          in: query
          required: false
          description: 加速器节点类型名称
          schema:
            type: string
            pattern: '^[a-zA-Z0-9._-]*$'
            minLength: 1
            maxLength: 36
        - name: sort_dir
          in: query
          required: false
          description: '排序顺序, 取值为asc(升序), desc(降序)'
          schema:
            type: array
            items:
              type: string
              pattern: "asc|desc"
        - name: sort_key
          in: query
          required: false
          description: '排序字段名称,取值为name(加速器节点类型名称)'
          schema:
            type: array
            items:
              type: string
              pattern: "name"
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListNodeTypesResponseBody'
  '/v1/{project_id}/accelerator-flavors-sell-status':
    get:
      tags:
        - EAS
        - Flavor
      summary: 查询设备规格状态列表
      description: 查询设备规格状态列表
      operationId: ListAcceleratorFlavorsStatus
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Marker'
        - name: accelerator_flavor_id
          in: query
          required: false
          description: 加速器规格id
          schema:
            type: array
            items:
              type: string
              pattern: '^[a-zA-Z0-9._-]*$'
              minLength: 1
              maxLength: 36
        - name: availability_zone_id
          in: query
          required: false
          description: 可用区id
          schema:
            type: array
            items:
              type: string
              minLength: 1
              maxLength: 100
        - name: sell_status
          in: query
          required: false
          description: 加速器规格状态
          schema:
            type: array
            items:
              type: string
              pattern: "normal|sellout|obt|obt_sellout|promotion"
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListFlavorsStatusResponseBody'
  '/v1/{project_id}/accelerator-node-types-sell-status':
    get:
      tags:
        - EAS
        - NodeType
      summary: 查询加速器节点类型售卖状态列表
      description: 查询加速器节点类型售卖状态列表
      operationId: ListAcceleratorNodeTypesStatus
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Marker'
        - name: accelerator_node_type_id
          in: query
          required: false
          description: 加速器节点类型id
          schema:
            type: array
            items:
              type: string
              pattern: '^[a-zA-Z0-9._-]*$'
              minLength: 1
              maxLength: 36
        - name: availability_zone_id
          in: query
          required: false
          description: 可用区id
          schema:
            type: array
            items:
              type: string
              minLength: 1
              maxLength: 100
        - name: sell_status
          in: query
          required: false
          description: 加速器节点类型状态
          schema:
            type: array
            items:
              type: string
              pattern: "normal|sellout|obt|obt_sellout|promotion"
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListNodeTypesStatusResponseBody'
  '/v1/{project_id}/accelerator-pools':
    post:
      tags:
        - EAS
        - Pool
      summary: 创建资源池
      operationId: CreateAcceleratorPool
      x-huawei-security:
        policyCheck:
          adminRule: 'role:op_service'
          freezedRule: 'not role:op_suspended and not role:op_restricted'
          authRule: 'role:te_admin'
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
      requestBody:
        description: 请求参数消息体
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAcceleratorPoolRequestBody'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateAcceleratorPoolResponseBody'
    get:
      tags:
        - EAS
        - Pool
      summary: 获取资源池列表
      operationId: ListAcceleratorPools
      x-huawei-security:
        policyCheck:
          adminRule: 'role:op_service'
          authRule: 'role:te_admin or role:readonly'
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Marker'
        - name: sort_dir
          in: query
          required: false
          description: '排序顺序, 取值为asc(升序), desc(降序)'
          schema:
            type: array
            items:
              type: string
              pattern: "asc|desc"
        - name: sort_key
          in: query
          required: false
          description: 排序字段名称
          schema:
            type: array
            items:
              type: string
              pattern: "name|id"
        - name: name
          in: query
          required: false
          description: 资源池名称
          schema:
            type: string
            pattern: '^[a-zA-Z0-9\u4e00-\u9fa5-._]*$'
            minLength: 0
            maxLength: 64
        - name: id
          in: query
          required: false
          description: 资源池ID
          schema:
            type: array
            minItems: 0
            maxItems: 10
            items:
              type: string
              pattern: >-
                [a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListAcceleratorPoolsResponseBody'
  '/v1/{project_id}/accelerator-pools/{accelerator_pool_id}':
    get:
      tags:
        - EAS
        - Pool
      summary: 获取资源池的信息
      operationId: ShowAcceleratorPool
      x-huawei-security:
        policyCheck:
          adminRule: 'role:op_service'
          authRule: 'role:te_admin or role:readonly'
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - name: accelerator_pool_id
          in: path
          required: true
          description: 资源池ID
          schema:
            type: string
            pattern: >-
              [a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShowAcceleratorPoolResponseBody'
    put:
      tags:
        - EAS
        - Pool
      summary: 更新资源池的信息
      operationId: UpdateAcceleratorPool
      x-huawei-security:
        policyCheck:
          adminRule: 'role:op_service'
          freezedRule: 'not role:op_suspended'
          authRule: 'role:te_admin'
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - name: accelerator_pool_id
          in: path
          required: true
          description: 资源池ID
          schema:
            type: string
            pattern: >-
              [a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}
      requestBody:
        description: 请求参数对象
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAcceleratorPoolRequestBody'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateAcceleratorPoolResponseBody'
    delete:
      tags:
        - EAS
        - Pool
      summary: 删除资源池
      operationId: DeleteAcceleratorPool
      x-huawei-security:
        policyCheck:
          adminRule: 'role:op_service'
          freezedRule: 'not role:op_suspended'
          authRule: 'role:te_admin'
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - name: accelerator_pool_id
          in: path
          required: true
          description: 资源池ID
          schema:
            type: string
            pattern: >-
              [a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}
      responses:
        '204':
          description: no content
  '/v1/{project_id}/credentials':
    get:
      tags:
        - EAS
        - AcceleratorCred
      summary: 查询加速器连接凭证列表
      description: 查询加速器详情列表
      operationId: ListAcceleratorCreds
      x-huawei-security:
        policyCheck:
          adminRule: 'role:op_service'
          freezedRule: 'not role:op_suspended and not role:op_restricted'
          authRule: 'role:te_admin'
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Marker'
        - name: id
          in: query
          required: false
          description: 加速器凭证ID
          schema:
            type: array
            items:
              type: string
              pattern: >-
                [a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}
        - name: name
          in: query
          required: false
          description: 加速器凭证名称
          schema:
            type: string
            pattern: '^[a-zA-Z0-9\u4e00-\u9fa5-._]*$'
      responses:
        '200':
          description: successful opration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListAcceleratorCredResponseBody'
  '/v1/{project_id}/credentials/{credential_id}':
    get:
      tags:
        - EAS
        - AcceleratorCred
      summary: 查询加速器连接凭证详情
      description: 查询加速器连接凭证详情
      operationId: ShowAcceleratorCred
      x-huawei-security:
        policyCheck:
          adminRule: 'role:op_service'
          freezedRule: 'not role:op_suspended and not role:op_restricted'
          authRule: 'role:te_admin'
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Marker'
        - name: credential_id
          in: path
          required: true
          description: 连接凭证ID
          schema:
            type: string
            pattern: >-
              [a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}
      responses:
        '200':
          description: successful opration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShowAcceleratorCredResponseBody'
  '/v1/{project_id}/credentials/{credential_id}/actions/rotate':
    post:
      tags:
        - EAS
        - AcceleratorCred
      summary: 轮换加速器连接凭证
      description: 轮换加速器连接凭证
      operationId: RotateAcceleratorCred
      x-huawei-security:
        policyCheck:
          adminRule: 'role:op_service'
          freezedRule: 'not role:op_suspended and not role:op_restricted'
          authRule: 'role:te_admin'
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - name: credential_id
          in: path
          required: true
          description: 连接凭证Id
          schema:
            type: string
            pattern: >-
              [a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}
      responses:
        '202':
          description: successful opration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RotateAcceleratorCredResponseBody'
  '/v1/{project_id}/accelerator-drivers':
    get:
      tags:
        - EAS
        - AcceleratorDriver
      summary: 查询加速器驱动列表
      description: 查询极速器驱动列表
      operationId: ListAcceleratorDrivers
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Marker'
        - name: name
          in: query
          required: false
          description: 加速器驱动名称
          schema:
            type: string
            pattern: "^[a-zA-Z0-9\u4e00-\u9fa5-._]*$"
            minLength: 1
            maxLength: 64
        - name: provide_api
          in: query
          required: false
          description: 驱动支持的API类型
          schema:
            type: array
            minItems: 0
            maxItems: 100
            items:
              type: string
              minLength: 1
              maxLength: 64
        - name: id
          in: query
          required: false
          description: driver id
          schema:
            type: array
            minItems: 0
            maxItems: 100
            items:
              type: string
              pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
        - name: sort_dir
          in: query
          required: false
          description: '排序顺序, 取值为asc(升序), desc(降序)'
          schema:
            type: array
            items:
              type: string
              pattern: "asc|desc"
        - name: sort_key
          in: query
          required: false
          description: '排序字段名称,取值为id(驱动id), name(驱动名称), provide_api(支持的API)'
          schema:
            type: array
            minItems: 0
            maxItems: 3
            items:
              type: string
              pattern: "id|name|provide_api"
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListDriversResponseBody'
  '/v1/{project_id}/accelerator-drivers/{accelerator_driver_id}':
    get:
      tags:
        - EAS
        - AcceleratorDriver
      summary: 查询加速器驱动详情
      description: 查询加速器驱动详情
      operationId: ShowAcceleratorDriver
      parameters:
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/ProjectId'
        - name: accelerator_driver_id
          in: path
          description: 驱动id
          required: true
          schema:
            type: string
            pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShowDriverResponseBody'
  /v1/{project_id}/accelerator-pools/{accelerator_pool_id}/nodes:
    post:
      tags:
        - EAS
        - Node
      summary: 池扩容
      operationId: CreateAcceleratorNodes
      x-huawei-security:
        policyCheck:
          adminRule: role:op_service
          freezedRule: not role:op_suspended and not role:op_restricted
          authRule: role:te_admin
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/AcceleratorPoolId'
      requestBody:
        description: 请求参数消息体
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateNodesRequestBody'
      responses:
        '202':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateNodesResponseBody'
    get:
      tags:
        - EAS
        - Node
      summary: 获取池节点列表
      operationId: ListAcceleratorNodes
      x-huawei-security:
        policyCheck:
          adminRule: role:op_service
          authRule: role:te_admin or role:readonly
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Marker'
        - $ref: '#/components/parameters/AcceleratorPoolId'
        - name: sort_key
          in: query
          description: 排序字段名称
          schema:
            type: array
            items:
              type: string
              pattern: "id|name"
        - name: sort_dir
          in: query
          description: 排序顺序
          schema:
            type: array
            items:
              type: string
              pattern: "asc|desc"
        - name: name
          in: query
          required: false
          description: "池节点名称"
          schema:
            type: string
            minLength: 1
            maxLength: 64
            pattern: '^[a-zA-Z0-9\u4e00-\u9fa5-._]*$'
        - name: id
          in: query
          required: false
          description: "池节点ID列表"
          schema:
            type: array
            minItems: 1
            maxItems: 10
            items:
              type: string
              pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListNodesResponseBody'
  /v1/{project_id}/accelerator-pools/{accelerator_pool_id}/nodes/batch-delete:
    post:
      tags:
        - EAS
        - Node
      summary: 池缩容
      operationId: BatchDeleteAcceleratorNodes
      x-huawei-security:
        policyCheck:
          adminRule: role:op_service
          freezedRule: not role:op_suspended
          authRule: role:te_admin
      parameters:
        - $ref: '#/components/parameters/ProjectId'
        - $ref: '#/components/parameters/AuthToken'
        - $ref: '#/components/parameters/AcceleratorPoolId'
      requestBody:
        description: 请求参数消息体
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteNodesRequestBody'
      responses:
        '202':
          description: successful operation

components:
  parameters:
    AuthToken:
      name: X-Auth-Token
      in: header
      description: auth token
      required: true
      schema:
        type: string
    ProjectId:
      name: project_id
      in: path
      description: project id
      required: true
      schema:
        type: string
        pattern: '[a-fA-F0-9]{32}'
    Limit:
      name: limit
      in: query
      description: max number of resources to return
      required: false
      schema:
        type: integer
        format: int32
        minimum: 1
        maximum: 1000
    Marker:
      name: marker
      in: query
      description: next page resource index id
      required: false
      schema:
        type: string
    AcceleratorPoolId:
      name: accelerator_pool_id
      in: path
      description: accelerator pool id
      required: true
      schema:
        type: string
        pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
  schemas:
    ResponsePageInfoV3:
      type: object
      properties:
        previous_marker:
          x-ifnull: hide
          type: string
        next_marker:
          x-ifnull: hide
          type: string
    CreateAcceleratorsRequestBody:
      type: object
      required:
        - accelerator
      properties:
        accelerator:
          type: object
          required:
            - name
            - driver_id
            - flavor_id
            - network
            - availability_zone_id
          properties:
            placement:
              type: object
              properties:
                pool_id:
                  type: string
                  pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
                  description: 加速池id
            name:
              type: string
              description: 加速器的名称
              pattern: '^[a-zA-Z0-9一-龥-._]*$'
              minLength: 1
              maxLength: 64
            flavor_id:
              type: string
              minLength: 1
              maxLength: 36
              description: 使用的flavor id
            driver_id:
              type: string
              pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
              description: 使用的drier id
            allow_auto_rename:
              type: boolean
              description: 是否允许自动命名
              default: false
            network:
              type: object
              properties:
                type:
                  type: string
                  pattern: "normal|rdma"
                virsubnet_id:
                  type: string
                  description: 子网id
                  pattern: >-
                    [a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}
              required:
                - virsubnet_id
                - type
              description: 设备使用的subnet id
            max_count:
              type: integer
              format: int32
              description: 创建的加速器数量
              default: 1
              minimum: 1
              maximum: 100
            min_count:
              type: integer
              format: int32
              description: 创建的加速器数量
              minimum: 1
              maximum: 100
              default: 1
            availability_zone_id:
              type: string
              minLength: 1
              maxLength: 100
              description: 指定创建可用区
            bss_param:
              type: object
              properties:
                charging_mode:
                  type: string
                  pattern: "post_paid"
                  description: 计费模式，默认按需
                  default: post_paid
    CreateAcceleratorsResponseBody:
      type: object
      properties:
        accelerators:
          type: array
          items:
            type: string
    ShowFlavorResponseBody:
      type: object
      properties:
        accelerator_flavor:
          $ref: '#/components/schemas/FlavorDetail'
    ShowNodeTypeResponseBody:
      type: object
      properties:
        accelerator_node_type:
          $ref: '#/components/schemas/NodeTypeDetail'
    FlavorDetail:
      type: object
      properties:
        id:
          type: string
          description: 加速器规格id
        family_id:
          type: string
          description: 规格族
        provide_api:
          type: string
          description: 加速器规格驱动类型
        name:
          type: string
          description: 加速器规格名称
        computing_power:
          $ref: "#/components/schemas/ComputingPowerDetail"
        topology:
          type: array
          description: 加速器芯片的拓扑结构
          items:
            $ref: "#/components/schemas/TopologyDetail"
    NodeTypeDetail:
      type: object
      properties:
        id:
          type: string
          description: 加速器节点类型id
        name:
          type: string
          description: 加速器节点类型名称
        family_id:
          type: string
          description: 调度时候使用，console不显示
        provide_apis:
          type: array
          description: 加速器节点类型所支持的驱动
          items:
            type: string
        accelerator_flavors:
          type: array
          description: 节点类型对应的加速器规格
          items:
            $ref: "#/components/schemas/FlavorDetail"
        computing_power:
          $ref: "#/components/schemas/ComputingPowerDetail"
    ComputingPowerDetail:
      type: object
      properties:
        fp16:
          type: integer
          format: int64
          description: 每秒浮点运算次数
        memory:
          type: integer
          format: int64
          description: 内存
    TopologyDetail:
      type: object
      properties:
        fp16:
          type: integer
          format: int64
          description: 每秒浮点运算次数
        memory:
          type: integer
          format: int64
          description: 内存
    ListFlavorsResponseBody:
      type: object
      properties:
        accelerator_flavors:
          type: array
          description: 加速器规格列表
          items:
            $ref: '#/components/schemas/FlavorDetail'
        page_info:
          $ref: '#/components/schemas/ResponsePageInfoV3'
    ListNodeTypesResponseBody:
      type: object
      properties:
        accelerator_node_types:
          type: array
          description: 加速器节点类型列表
          items:
            $ref: '#/components/schemas/NodeTypeDetail'
        page_info:
          $ref: '#/components/schemas/ResponsePageInfoV3'
    ListFlavorsStatusResponseBody:
      type: object
      properties:
        accelerator_flavors_sell_status:
          type: array
          description: 可用区规格状态信息
          items:
            $ref: "#/components/schemas/FlavorStatusDetail"
        page_info:
          $ref: "#/components/schemas/ResponsePageInfoV3"
    FlavorStatusDetail:
      type: object
      properties:
        accelerator_flavor_id:
          type: string
          description: 加速器规格id
        availability_zone_id:
          type: string
          description: 可用区id
        sell_status:
          type: string
          description: 设备规格状态,取值[normal：正常商用,abandon：下线（即不显示）,sellout：售罄,obt：公测,obt_sellout：公测售罄]
    ListNodeTypesStatusResponseBody:
      type: object
      properties:
        accelerator_node_types_sell_status:
          type: array
          description: 可用区规格状态信息
          items:
            $ref: "#/components/schemas/NodeTypeStatusDetail"
        page_info:
          $ref: "#/components/schemas/ResponsePageInfoV3"
    NodeTypeStatusDetail:
      type: object
      properties:
        accelerator_node_type_id:
          type: string
          description: 加速器节点类型id
        availability_zone_id:
          type: string
          description: 可用区id
        sell_status:
          type: string
          description: 加速器节点类型状态,取值[normal：正常商用,abandon：下线（即不显示）,sellout：售罄,obt：公测,obt_sellout：公测售罄]
    ListAcceleratorResponseBody:
      type: object
      properties:
        accelerators:
          type: array
          description: 加速器列表
          items:
            $ref: '#/components/schemas/AcceleratorDetail'
        page_info:
          $ref: '#/components/schemas/ResponsePageInfoV3'
    AcceleratorDetail:
      type: object
      properties:
        pool:
          type: object
          description: 加速器池
          properties:
            id:
              description: 加速器池id
              type: string
              x-ifnull: hide
            name:
              type: string
              description: 加速器池名
              x-ifnull: hide
        name:
          type: string
          description: 加速器名称
        id:
          type: string
          description: 加速器ID
        credential:
          type: object
          description: 凭证信息，如果加速器处于创建中，此信息可能为空
          properties:
            id:
              description: 凭证ID,如果加速器处于创建中，此字段可能不返回
              type: string
            access_token:
              type: string
              description: 凭证的访问令牌数据,如果加速器处于创建中，此字段可能不返回
        node_id:
          type: string
          description: 节点id
        flavor:
          type: object
          description: 加速器规格
          properties:
            id:
              type: string
              description: 规格ID
            computing_power:
              $ref: "#/components/schemas/ComputingPowerDetail"
        driver:
          type: object
          description: 加速器驱动
          properties:
            id:
              type: string
              description: 驱动ID
        availability_zone_id:
          type: string
          description: 加速器所在az
        status:
          type: string
          description: 加速器状态
        network:
          type: object
          description: 加速器网络信息
          properties:
            type:
              type: string
              description: 加速器网卡类型
            virsubnet_id:
              type: string
              description: 加速器所在的子网ID
            ip_address:
              type: string
              description: 加速器内网IP地址
            listen_port:
              type: integer
              description: 加速器监听端口号
        client_infos:
          type: array
          items:
            type: object
            properties:
              ip_address:
                type: string
              port:
                type: integer
        created_at:
          type: string
          format: date-time
          description: 加速器创建时间
        updated_at:
          type: string
          format: date-time
          description: 加速器更新时间
    ShowAcceleratorResponseBody:
      type: object
      properties:
        accelerator:
          $ref: '#/components/schemas/AcceleratorDetail'
    UpdateAcceleratorResponseBody:
      type: object
      properties:
        accelerator:
          $ref: '#/components/schemas/AcceleratorDetail'
    DeleteAcceleratorsRequestBody:
      type: object
      required:
        - accelerators
      properties:
        accelerators:
          type: array
          minItems: 1
          maxItems: 100
          description: 加速器id列表
          items:
            type: string
            pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
    DeleteAcceleratorsResponseBody:
      type: object
      properties:
        accelerators:
          type: array
          description: 资源信息
          items:
            type: string
    CreateAcceleratorPoolRequestBody:
      type: object
      properties:
        accelerator_pool:
          $ref: '#/components/schemas/CreateAcceleratorPoolRequestDetail'
    CreateAcceleratorPoolRequestDetail:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 64
          description: 资源池名称
          pattern: '^[a-zA-Z0-9\u4e00-\u9fa5-._]*$'
        default_virsubnet_id:
          type: string
          description: 默认子网id
          pattern: "[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}"
        default_drivers:
          type: array
          minItems: 1
          maxItems: 10
          description: 默认驱动id列表
          items:
            type: string
            pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
    CreateAcceleratorPoolResponseBody:
      type: object
      properties:
        accelerator_pool:
          $ref: '#/components/schemas/CreateAcceleratorPoolDetail'
    ListAcceleratorPoolsResponseBody:
      type: object
      required:
        - pools
        - page_info
      properties:
        accelerator_pools:
          type: array
          description: 资源池列表
          items:
            $ref: '#/components/schemas/PoolDetail'
        page_info:
          $ref: '#/components/schemas/ResponsePageInfoV3'
    CreateAcceleratorPoolDetail:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: string
          description: 资源池ID
        name:
          type: string
          description: 资源池名称
        default_virsubnet_id:
          type: string
          description: 默认子网id
        default_drivers:
          type: array
          minItems: 0
          maxItems: 10
          description: 默认驱动id列表
          items:
            type: string
    PoolDetail:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: string
          description: 资源池ID
        name:
          type: string
          description: 资源池名称
        node_count:
          type: integer
          description: 节点数
        accelerator_count:
          type: integer
          description: 加速器个数
        default_virsubnet_id:
          type: string
          description: 默认子网id
        default_drivers:
          type: array
          minItems: 0
          maxItems: 10
          description: 默认驱动id列表
          items:
            type: string
        created_at:
          type: string
          format: date-time
          description: 创建时间
        updated_at:
          type: string
          format: date-time
          description: 最后更新时间
    ShowAcceleratorPoolResponseBody:
      type: object
      properties:
        accelerator_pool:
          $ref: '#/components/schemas/PoolDetail'
    UpdateAcceleratorPoolRequestBody:
      type: object
      properties:
        accelerator_pool:
          $ref: '#/components/schemas/UpdateAcceleratorPoolRequestDetail'
    UpdateAcceleratorPoolRequestDetail:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          minLength: 0
          maxLength: 64
          description: 资源池名称
          pattern: '^[a-zA-Z0-9\u4e00-\u9fa5-._]*$'
        default_virsubnet_id:
          type: string
          pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
          description: 默认子网id
        default_drivers:
          type: array
          minItems: 1
          maxItems: 10
          description: 默认驱动id列表
          items:
            pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
            type: string
    UpdateAcceleratorPoolResponseBody:
      type: object
      properties:
        accelerator_pool:
          $ref: '#/components/schemas/PoolDetail'
    UpdateAcceleratorRequestBody:
      type: object
      required:
        - accelerator
      properties:
        accelerator:
          type: object
          properties:
            name:
              type: string
              pattern: "^[a-zA-Z0-9\u4e00-\u9fa5-._]*$"
              minLength: 1
              maxLength: 64
              description: 加速器名称
    ShowAcceleratorCredResponseBody:
      type: object
      properties:
        credential:
          $ref: '#/components/schemas/AcceleratorCredDetail'
    AcceleratorCredDetail:
      type: object
      properties:
        name:
          type: string
          description: 凭证的名称
          pattern: '^[a-zA-Z0-9一-龥-._]*$'
          minLength: 1
          maxLength: 58
        id:
          type: string
          description: 凭证uuid
        access_token:
          type: string
          description: 凭证的访问令牌数据
        created_at:
          type: string
          format: date-time
          description: 凭证创建时间
        updated_at:
          type: string
          format: date-time
          description: 凭证更新时间
        status:
          type: string
          enum:
            - normal
            - abnormal
            - rotating
          description: 凭证状态
    ListAcceleratorCredResponseBody:
      type: object
      properties:
        credentials:
          type: array
          description: 连接凭证列表
          items:
            $ref: '#/components/schemas/AcceleratorCredDetail'
        page_info:
          $ref: '#/components/schemas/ResponsePageInfoV3'
    RotateAcceleratorCredResponseBody:
      type: object
      properties:
        credential:
          type: object
          properties:
            id:
              type: string
    ListDriversResponseBody:
      type: object
      properties:
        accelerator_drivers:
          type: array
          description: 驱动列表
          items:
            $ref: '#/components/schemas/DriverDetail'
        page_info:
          $ref: '#/components/schemas/ResponsePageInfoV3'
    ShowDriverResponseBody:
      type: object
      properties:
        accelerator_driver:
          $ref: '#/components/schemas/DriverDetail'
    DriverDetail:
      type: object
      properties:
        id:
          type: string
          description: 驱动id
        name:
          type: string
          description: 驱动名称
        description:
          type: string
          description: 描述
        provide_api:
          type: string
          description: 驱动名称
        version:
          type: string
          description: 驱动版本
        min_sdk_version:
          type: string
          description: 驱动支持的前端SDK的最旧版本
        max_sdk_version:
          type: string
          description: 驱动支持的前端SDK的最新版本
        is_public:
          type: boolean
          description: is public
    CreateNodesRequestBody:
      type: object
      properties:
        node:
          $ref: '#/components/schemas/CreateNodesRequestDetail'
    CreateNodesRequestDetail:
      type: object
      required:
        - max_count
        - min_count
        - name
        - availability_zone_id
        - flavor_id
        - bss_param
      properties:
        max_count:
          type: integer
          description: 扩容节点的最大数量
          minimum: 1
          maximum: 100
          default: 1
        min_count:
          type: integer
          description: 扩容节点的最小数量
          minimum: 1
          maximum: 100
          default: 1
        name:
          type: string
          minLength: 1
          maxLength: 64
          description: 节点名称
          pattern: '^[a-zA-Z0-9\u4e00-\u9fa5-._]*$'
        allow_auto_rename:
          type: boolean
          description: 是否允许重命名，当扩容的节点数大于1时生效
          default: false
        availability_zone_id:
          type: string
          description: 可用区id
        flavor_id:
          type: string
          description: 节点规格id
        bss_param:
          type: object
          description: 运营信息
          properties:
            charging_mode:
              type: string
              description: 计费模式
              enum:
                - post_paid
                - pre_paid
              default: post_paid
    CreateNodesResponseBody:
      type: object
      properties:
        nodes:
          type: array
          items:
            type: string
            pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
    ListNodesResponseBody:
      type: object
      required:
        - nodes
        - page_info
      properties:
        nodes:
          type: array
          description: 节点列表
          items:
            $ref: '#/components/schemas/NodeDetail'
        page_info:
          $ref: '#/components/schemas/ResponsePageInfoV3'
    NodeDetail:
      type: object
      properties:
        id:
          type: string
          description: 节点ID
        name:
          type: string
          description: 节点名称
        availability_zone_id:
          type: string
          description: 可用区id
        flavor_id:
          type: string
          description: 节点规格id
        status:
          type: string
          description: 节点状态
        created_at:
          type: string
          format: date-time
          description: 创建时间
        updated_at:
          type: string
          format: date-time
          description: 最后更新时间
    DeleteNodesRequestBody:
      type: object
      properties:
        nodes:
          type: array
          minItems: 1
          maxItems: 10
          items:
            type: string
            pattern: '[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}'
